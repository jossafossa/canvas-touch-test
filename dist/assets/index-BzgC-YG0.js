(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const r of i)if(r.type==="childList")for(const d of r.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&s(d)}).observe(document,{childList:!0,subtree:!0});function t(i){const r={};return i.integrity&&(r.integrity=i.integrity),i.referrerPolicy&&(r.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?r.credentials="include":i.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(i){if(i.ep)return;i.ep=!0;const r=t(i);fetch(i.href,r)}})();class h extends Event{constructor(e,t){super(e),this.pointers=[];let s=t.type??"drag";s==="drag"&&this.drag(t),s==="pointermove"&&this.pointerMove(t),s==="touchmove"&&this.touchMove(t)}drag(e){this.pointers=e.pointers}pointerMove(e){this.pointers.push({id:e.pointerId,x:e.clientX,y:e.clientY,size:10})}touchMove(e){for(let t=0;t<e.touches.length;t++){let s=e.touches[t];console.log(s),this.pointers.push({id:s.identifier,x:s.clientX,y:s.clientY,size:(s.radiusX+s.radiusY)*s.force/2})}}}class g extends EventTarget{constructor(e){super(),this.root=e,this.root.addEventListener("touchmove",t=>{this.dispatchEvent(new h("drag",t))}),this.root.addEventListener("touchend",t=>{this.dispatchEvent(new h("dragend",t))})}}class p extends EventTarget{constructor(e){super(),this.root=e,this.isDragging=!1,this.root.addEventListener("pointerdown",t=>{this.isDragging=!0}),this.root.addEventListener("pointerup",t=>{this.dispatchEvent(new h("dragend",{pointers:[]})),this.isDragging=!1}),this.root.addEventListener("pointermove",t=>{this.isDragging&&this.dispatchEvent(new h("drag",t))})}}class m{constructor(e){this.buffer=[],this.size=e}smooth(e){return this.buffer.push(e),this.buffer.length>this.size&&this.buffer.shift(),this.buffer.reduce((s,i)=>s+i)/this.buffer.length}}class c{constructor(e,t=["x","y"]){this.buffers=new Map,this.size=e,this.attributes=t;for(let s of t)this.buffers.set(s,new m(e))}smooth(e){const t={...e};for(let s of this.attributes)t[s]=this.buffers.get(s).smooth(e[s]);return console.log({copy:t,all:e,attribute:this.attributes,buffers:this.buffers}),t}}class v extends EventTarget{constructor(e,t={}){super(),this.settings={smooth:30,...t},this.buffers=new Map,this.event=new h("drag",{pointers:[]}),this.pointers=[],this.buffer=new c(this.settings.smooth),this.root=e,this.touchListener=new g(this.root),this.mouseListener=new p(this.root),[this.mouseListener,this.touchListener].forEach(s=>{s.addEventListener("drag",i=>{this.event=i}),s.addEventListener("dragend",()=>{this.buffers.clear(),this.event=new h("dragend",{pointers:[]}),this.dispatchEvent(this.event)})}),this.loop()}loop(){var s;let e=((s=this.event)==null?void 0:s.pointers)??[],t=[];for(let i of e){let r=this.buffers.get(i.id);r||(r=new c(this.settings.smooth,["x","y","size"]),this.buffers.set(i.id,r));let d=r.smooth(i);t.push(d)}this.dispatchEvent(new h("drag",{pointers:t})),window.requestAnimationFrame(()=>{this.loop()})}}let u=document.querySelector("#root");u.width=window.innerWidth;u.height=window.innerHeight;let l=new v(u,{smooth:10});const n=u.getContext("2d"),b=(o,e=1)=>{let t=[`rgba( 255, 0, 0, ${e} )`,`rgba( 0, 255, 0, ${e} )`,`rgba( 0, 0, 255, ${e} )`,`rgba( 255, 255, 0, ${e} )`,`rgba( 0, 255, 255, ${e} )`,`rgba( 255, 0, 255, ${e} )`];o=o.toString();let s=0;for(let i=0;i<o.length;i++)s+=o.charCodeAt(i);return s=s%t.length,t[s]};let a=0,f=new Map;l.addEventListener("dragend",o=>{console.log("dragend"),f=new Map,a++});l.addEventListener("drag",o=>{let e=o.pointers??[];for(let t of e){let s=b(t.id+a);n.fillStyle=s,n.beginPath(),n.arc(t.x,t.y,t.size,0,Math.PI*2),n.fill(),n.closePath();let i=f.get(t.id);i&&(n.strokeStyle=s,n.lineWidth=t.size*2,n.beginPath(),n.moveTo(i.x,i.y),n.lineTo(t.x,t.y),n.stroke(),n.closePath()),f.set(t.id,t)}});
