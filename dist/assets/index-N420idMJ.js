(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const n of o.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&s(n)}).observe(document,{childList:!0,subtree:!0});function e(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(i){if(i.ep)return;i.ep=!0;const o=e(i);fetch(i.href,o)}})();class h extends Event{constructor(t,e){super(t),this.pointers=[];let s=e.type??"drag";["drag","dragstart","dragend"].includes(s)&&this.drag(e),["pointermove","pointerdown"].includes(s)&&this.pointerMove(e),s==="touchmove"&&this.touchMove(e)}drag(t){this.pointers=t.pointers}pointerMove(t){this.pointers.push({id:t.pointerId,x:t.clientX,y:t.clientY,size:10})}touchMove(t){for(let e=0;e<t.touches.length;e++){let s=t.touches[e];console.log(s),this.pointers.push({id:s.identifier,x:s.clientX,y:s.clientY,size:(s.radiusX+s.radiusY)*s.force/2})}}}class x extends EventTarget{constructor(t){super(),this.root=t,this.root.addEventListener("touchmove",e=>{this.dispatchEvent(new h("drag",e))}),this.root.addEventListener("touchend",e=>{this.dispatchEvent(new h("dragend",e))}),this.root.addEventListener("touchstart",e=>{this.dispatchEvent(new h("dragstart",e))})}}class L extends EventTarget{constructor(t){super(),this.root=t,this.isDragging=!1,this.root.addEventListener("pointermove",e=>{this.isDragging&&this.dispatchEvent(new h("drag",e))}),this.root.addEventListener("pointerdown",e=>{this.isDragging=!0,this.dispatchEvent(new h("dragstart",e))}),this.root.addEventListener("pointerup",e=>{this.dispatchEvent(new h("dragend",{pointers:[]})),this.isDragging=!1})}}class y{constructor(t){this.size=t,this.buffer=new Array(t).fill(0),this.index=0,this.count=0,this.sum=0}smooth(t){return this.sum-=this.buffer[this.index],this.buffer[this.index]=t,this.sum+=t,this.index=(this.index+1)%this.size,this.count=Math.min(this.count+1,this.size),this.sum/this.count}}class p{constructor(t,e=["x","y"]){this.buffers=new Map,this.size=t,this.attributes=e;for(let s of e)this.buffers.set(s,new y(t))}smooth(t){const e={...t};for(let s of this.attributes)e[s]=this.buffers.get(s).smooth(t[s]);return e}}class M extends EventTarget{constructor(t,e={}){super(),this.settings={smooth:30,...e},this.buffers=new Map,this.event=new h("drag",{pointers:[]}),this.pointers=[],this.buffer=new p(this.settings.smooth),this.root=t,this.touchListener=new x(this.root),this.mouseListener=new L(this.root),[this.mouseListener,this.touchListener].forEach(s=>{s.addEventListener("dragstart",i=>{this.event=i,this.dispatchEvent(new h("dragstart",i))}),s.addEventListener("drag",i=>{this.event=i}),s.addEventListener("dragend",()=>{this.buffers.clear(),this.event=new h("dragend",{pointers:[]}),this.dispatchEvent(this.event)})}),this.loop()}loop(){var s;let t=((s=this.event)==null?void 0:s.pointers)??[],e=[];for(let i of t){let o=this.buffers.get(i.id);o||(o=new p(this.settings.smooth,["x","y","size"]),this.buffers.set(i.id,o));let n=o.smooth(i);e.push(n)}this.dispatchEvent(new h("drag",{pointers:e})),window.requestAnimationFrame(()=>{this.loop()})}}let l=document.querySelector("#root"),c=window.devicePixelRatio??1;l.width=window.innerWidth*c;l.height=window.innerHeight*c;let m=new M(l,{smooth:5});const a=l.getContext("2d"),P=(r,t=1)=>{let e=[`rgba( 255, 0, 0, ${t} )`,`rgba( 0, 255, 0, ${t} )`,`rgba( 0, 0, 255, ${t} )`,`rgba( 255, 255, 0, ${t} )`,`rgba( 0, 255, 255, ${t} )`,`rgba( 255, 0, 255, ${t} )`];r=r.toString();let s=0;for(let i=0;i<r.length;i++)s+=r.charCodeAt(i);return s=s%e.length,e[s]};let v=0,u=new Map;m.addEventListener("dragend",r=>{console.log("dragend"),u=new Map,v++});const z=(r,t,e=2)=>{let s=[],i=t.x-r.x,o=t.y-r.y,n=Math.sqrt(i**2+o**2),f=Math.atan2(o,i),g=Math.floor(n/e);for(let d=0;d<g;d++){let w=r.x+Math.cos(f)*d*e,E=r.y+Math.sin(f)*d*e,b=r.size+(t.size-r.size)*(d/g);s.push({x:w,y:E,size:b})}return s},O=r=>{let t=r.pointers??[];for(let e of t){l.setPointerCapture(e.id);let s=P(e.id+v);a.fillStyle=s;let i=u.get(e.id),o=[e];i&&(o=z(i,e));for(let n of o)a.beginPath(),a.arc(n.x*c,n.y*c,n.size*c,0,Math.PI*2),a.fill(),a.closePath();u.set(e.id,e)}};["drag","dragstart"].forEach(r=>m.addEventListener(r,O));
